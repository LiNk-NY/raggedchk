<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Use cases and tables for the RaggedExperiment manuscript • RaggedExperiment.SoftNote</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Use cases and tables for the RaggedExperiment manuscript">
<meta property="og:description" content="The repository contains a real world example use of qreduceAssay
  via simplifyTCGA in the TCGAutils package, the code used to create the size
  comparisons table in the manuscript. The README provides some examples where
  RaggedExperiment is used with mutation data.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">RaggedExperiment.SoftNote</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/RaggedExperiment_Manuscript_Example.html">RaggedExperiment: Object Size Comparisons</a>
    </li>
    <li>
      <a href="articles/RaggedExperiment_Manuscript_qReduceAssay.html">qReduceAssay on BRCA with RaggedExperiment</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div class="section level1">
<div class="page-header"><h1 id="raggedexperiment-use-case">RaggedExperiment Use Case<a class="anchor" aria-label="anchor" href="#raggedexperiment-use-case"></a>
</h1></div>
<p>This repository provides reproducible examples and tables shown in the “RaggedExperiment: the missing link between genomic ranges and matrices in Bioconductor” manuscript. Below is an example use case provided by <a href="mailto:stvjc@channing.harvard.edu">Vincent J. Carey</a>. See the Articles section to see other use cases and table code.</p>
</div>
<div class="section level1">
<h1 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h1>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"RaggedExperiment"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"BiocManager"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">BiocManager</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/BiocManager/man/install.html" class="external-link">install</a></span><span class="op">(</span><span class="st">"RaggedExperiment"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="package-load">Package Load<a class="anchor" aria-label="anchor" href="#package-load"></a>
</h1>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">curatedTCGAData</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">TCGAutils</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Bioconductor/BiocParallel" class="external-link">BiocParallel</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/therneau/survival" class="external-link">survival</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">RaggedExperiment</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level1">
<h1 id="enumerate-mutations-by-symbol-in-brca-couple-to-overall-survival">Enumerate mutations by symbol in BRCA, couple to overall survival<a class="anchor" aria-label="anchor" href="#enumerate-mutations-by-symbol-in-brca-couple-to-overall-survival"></a>
</h1>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">suppressMessages</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="va">bmut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/curatedTCGAData/man/curatedTCGAData.html" class="external-link">curatedTCGAData</a></span><span class="op">(</span><span class="st">"BRCA"</span>, <span class="st">"Mutation"</span>, dry.run<span class="op">=</span><span class="cn">FALSE</span>, version<span class="op">=</span><span class="st">"2.0.1"</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TCGAutils/man/curatedTCGAData-helpers.html" class="external-link">sampleTables</a></span><span class="op">(</span><span class="va">bmut</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`BRCA_Mutation-20160128`</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  01  06 </span></span>
<span><span class="co">#&gt; 988   5</span></span></code></pre></div>
<div class="section level2">
<h2 id="filter-only-for-primary-solid-tumors-code-01">Filter only for primary solid tumors (code 01)<a class="anchor" aria-label="anchor" href="#filter-only-for-primary-solid-tumors-code-01"></a>
</h2>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bmut.srv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/TCGAutils/man/TCGAprimaryTumors.html" class="external-link">TCGAprimaryTumors</a></span><span class="op">(</span><span class="va">bmut</span><span class="op">)</span></span>
<span><span class="co">#&gt; harmonizing input:</span></span>
<span><span class="co">#&gt;   removing 5 sampleMap rows with 'colname' not in colnames of experiments</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/TCGAutils/man/curatedTCGAData-helpers.html" class="external-link">sampleTables</a></span><span class="op">(</span><span class="va">bmut.srv</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`BRCA_Mutation-20160128`</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  01 </span></span>
<span><span class="co">#&gt; 988</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="extract-raggedexperiment-from-multiassayexperiment">Extract RaggedExperiment from MultiAssayExperiment<a class="anchor" aria-label="anchor" href="#extract-raggedexperiment-from-multiassayexperiment"></a>
</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">rgmut</span> <span class="op">&lt;-</span> <span class="va">bmut.srv</span><span class="op">[[</span><span class="st">"BRCA_Mutation-20160128"</span><span class="op">]</span><span class="op">]</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="check-for-replicates">Check for replicates<a class="anchor" aria-label="anchor" href="#check-for-replicates"></a>
</h2>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/MultiAssayExperiment-helpers.html" class="external-link">anyReplicated</a></span><span class="op">(</span><span class="va">bmut.srv</span><span class="op">)</span></span>
<span><span class="co">#&gt; BRCA_Mutation-20160128 </span></span>
<span><span class="co">#&gt;                   TRUE</span></span>
<span></span>
<span><span class="co">## Obtain names of replicate samples by colData rowname</span></span>
<span><span class="va">replicates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Filter</a></span><span class="op">(</span><span class="va">length</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/MultiAssayExperiment-helpers.html" class="external-link">replicated</a></span><span class="op">(</span><span class="va">bmut.srv</span><span class="op">)</span><span class="op">[[</span><span class="st">"BRCA_Mutation-20160128"</span><span class="op">]</span><span class="op">]</span>,</span>
<span>      <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">rgmut</span><span class="op">)</span><span class="op">[</span><span class="va">x</span><span class="op">]</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="total-number-of-patients-with-replicates">Total number of patients with replicates<a class="anchor" aria-label="anchor" href="#total-number-of-patients-with-replicates"></a>
</h2>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/MultiAssayExperiment-helpers.html" class="external-link">replicated</a></span><span class="op">(</span><span class="va">bmut.srv</span><span class="op">)</span>, <span class="va">any</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 9</span></span>
<span><span class="co">## OR</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">replicates</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 9</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="remove-replicate-observations">Remove replicate observations<a class="anchor" aria-label="anchor" href="#remove-replicate-observations"></a>
</h2>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bmut.surv</span> <span class="op">&lt;-</span> <span class="va">bmut.srv</span><span class="op">[</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"BRCA_Mutation-20160128"</span> <span class="op">=</span></span>
<span>        <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">rgmut</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">replicates</span>, <span class="va">tail</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">]</span></span>
<span><span class="co">#&gt; harmonizing input:</span></span>
<span><span class="co">#&gt;   removing 11 sampleMap rows with 'colname' not in colnames of experiments</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="http://waldronlab.io/MultiAssayExperiment/reference/MultiAssayExperiment-helpers.html" class="external-link">anyReplicated</a></span><span class="op">(</span><span class="va">bmut.surv</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="see-mutation-classifications">See mutation classifications<a class="anchor" aria-label="anchor" href="#see-mutation-classifications"></a>
</h2>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ragex</span> <span class="op">&lt;-</span> <span class="va">bmut.surv</span><span class="op">[[</span><span class="st">"BRCA_Mutation-20160128"</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">mcols</span><span class="op">(</span><span class="va">ragex</span><span class="op">)</span><span class="op">$</span><span class="va">Variant_Classification</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Frame_Shift_Del   Frame_Shift_Ins      In_Frame_Del      In_Frame_Ins Missense_Mutation Nonsense_Mutation  Nonstop_Mutation               RNA            Silent </span></span>
<span><span class="co">#&gt;              3162              2567               627               161             55063              4841               133              4474             17901 </span></span>
<span><span class="co">#&gt;       Splice_Site </span></span>
<span><span class="co">#&gt;              1561</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="select-only-non-silent-mutations">Select only non-silent mutations<a class="anchor" aria-label="anchor" href="#select-only-non-silent-mutations"></a>
</h2>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## mcolsFilter (?)</span></span>
<span><span class="va">ragex</span> <span class="op">&lt;-</span> <span class="va">ragex</span><span class="op">[</span><span class="fu">mcols</span><span class="op">(</span><span class="va">ragex</span><span class="op">)</span><span class="op">$</span><span class="va">Variant_Classification</span> <span class="op">!=</span> <span class="st">"Silent"</span>,  <span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">mcols</span><span class="op">(</span><span class="va">ragex</span><span class="op">)</span><span class="op">$</span><span class="va">Variant_Classification</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Frame_Shift_Del   Frame_Shift_Ins      In_Frame_Del      In_Frame_Ins Missense_Mutation Nonsense_Mutation  Nonstop_Mutation               RNA       Splice_Site </span></span>
<span><span class="co">#&gt;              3162              2567               627               161             55063              4841               133              4474              1561</span></span>
<span><span class="va">bmut</span><span class="op">[[</span><span class="st">"BRCA_Mutation-20160128"</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="va">ragex</span></span>
<span><span class="co">#&gt; harmonizing input:</span></span>
<span><span class="co">#&gt;   removing 16 sampleMap rows with 'colname' not in colnames of experiments</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="set-up-survival-time">Set up survival time<a class="anchor" aria-label="anchor" href="#set-up-survival-time"></a>
</h2>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">colData</span><span class="op">(</span><span class="va">bmut.surv</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu">colData</span><span class="op">(</span><span class="va">bmut</span><span class="op">)</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">bmut</span><span class="op">$</span><span class="va">OS.Time</span><span class="op">)</span>, <span class="op">]</span></span>
<span><span class="co">#&gt; harmonizing input:</span></span>
<span><span class="co">#&gt;   removing 184 sampleMap rows with 'primary' not in colData</span></span>
<span><span class="va">osurv</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/survival/man/Surv.html" class="external-link">Surv</a></span><span class="op">(</span><span class="va">bmut.surv</span><span class="op">$</span><span class="va">OS.Time</span><span class="op">/</span><span class="fl">365.25</span>, <span class="va">bmut.surv</span><span class="op">$</span><span class="va">OS.event</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="obtain-hugo_symbols-for-each-sample">Obtain Hugo_Symbols for each sample<a class="anchor" aria-label="anchor" href="#obtain-hugo_symbols-for-each-sample"></a>
</h2>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">mutsyms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span></span>
<span>          <span class="fu"><a href="https://rdrr.io/r/methods/as.html" class="external-link">as</a></span><span class="op">(</span><span class="va">bmut.surv</span><span class="op">[[</span><span class="st">"BRCA_Mutation-20160128"</span><span class="op">]</span><span class="op">]</span>, <span class="st">"GRangesList"</span><span class="op">)</span>,</span>
<span>          <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">Hugo_Symbol</span></span>
<span>        <span class="op">)</span>,</span>
<span>        <span class="st">"CharacterList"</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   3.349   0.000   3.349</span></span>
<span><span class="va">mutsyms</span></span>
<span><span class="co">#&gt; CharacterList of length 793</span></span>
<span><span class="co">#&gt; [["TCGA-A1-A0SB-01A-11D-A142-09"]] ABLIM1 ADAMTS20 CADM2 DTNB ENSG00000267261 MSH3 MYB NPIPL2 OR11H1 OTOR P2RY10 PIEZO1 SLC6A9 SOX15 SPTB TMEM247 ZNF566 ZNF574 ZNF777</span></span>
<span><span class="co">#&gt; [["TCGA-A1-A0SD-01A-11D-A10Y-09"]] ANK3 CASK CNTFR CPEB2 CSTL1 CXorf58 DCAF8 FAM182B GATA3 HECTD4 ... SLC44A3 SLFN14 SNX5 STK11IP SYNE1 TLR5 WDR72 ZFP91 ZNF544 ZNF740</span></span>
<span><span class="co">#&gt; [["TCGA-A1-A0SE-01A-11D-A099-09"]] APLF ARRDC4 B3GNT1 C3orf38 CDH1 DCDC2B FAM102A FAM102A FHL1 IMPDH2 ... SDR16C5 SYDE2 TBC1D12 TBL1X UNC13C WDR86 WDR91 ZFHX4 ZNF541</span></span>
<span><span class="co">#&gt; [["TCGA-A1-A0SF-01A-11D-A142-09"]] ACRBP ARL6IP6 BEST3 C9orf43 CECR2 CUL7 DDX53 DUSP27 EPPK1 EXT2 FIGN ... PTPRD RIT2 SFMBT2 SKOR1 SPPL2C ST7 TP73 TPH1 UBE2QL1 ZNF91</span></span>
<span><span class="co">#&gt; [["TCGA-A1-A0SG-01A-11D-A142-09"]] ARC BPIFB3 C2orf73 CECR2 CEP290 CSMD2 DSCAM DYSF ERN1 EWSR1 ... PADI2 PPID RNA5-8SP6 SCN7A SLC29A2 SYNPO2L TMEM99 TYSND1 ZNF217</span></span>
<span><span class="co">#&gt; [["TCGA-A1-A0SH-01A-11D-A099-09"]] ACSL4 AHCTF1 ALPK3 ANK3 ANKRD7 APOBR ARHGAP28 ASL ATPIF1 BDP1 ... TIFAB TMC8 TTC39A UNC93B1 UPRT USH2A WDR7 WDR87 ZFHX4 ZNF606</span></span>
<span><span class="co">#&gt; [["TCGA-A1-A0SI-01A-11D-A142-09"]] ABAT ABCA8 ACAN ACPP ACTR3B ADCK3 AGFG2 AHNAK AKR1C1 AKT2 ... ZNF345 ZNF366 ZNF419 ZNF436 ZNF436 ZNF518A ZNF673 ZNF701 ZNF790</span></span>
<span><span class="co">#&gt; [["TCGA-A1-A0SJ-01A-11D-A099-09"]] ALG1 AMZ2 ASCL3 CHML CILP COL20A1 ENSG00000235041 FAF2 FAM115C GJB2 ... RANBP6 SCN4A SNAI1 SPEN TH1L TRBV6-8 UBAP1L ZBTB11 ZNF543</span></span>
<span><span class="co">#&gt; [["TCGA-A1-A0SK-01A-12D-A099-09"]] ABCA11P ACBD5 AHNAK ALMS1P ANKRD36B ANKRD42 ARHGAP42 ARL11 ASB10 ... YIPF7 YTHDF2 ZNF234 ZNF417 ZNF469 ZNF469 ZNF66P ZNF717 ZNF777</span></span>
<span><span class="co">#&gt; [["TCGA-A1-A0SM-01A-11D-A099-09"]] AHDC1 ATP1A4 CLEC12A CP CSMD1 DCST1 EGR3 ESYT1 GOLGA3 HEATR4 ... SEZ6L2 SMARCA1 STEAP2 TBC1D8 TCTE1 TSNARE1 ZAN ZNF229 ZNF804B</span></span>
<span><span class="co">#&gt; ...</span></span>
<span><span class="co">#&gt; &lt;783 more elements&gt;</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="sample-mutations-tally">Sample mutations tally<a class="anchor" aria-label="anchor" href="#sample-mutations-tally"></a>
</h2>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">mutsyms</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/duplicated.html" class="external-link">duplicated</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    0    1    2    3    4    5    6    7    8    9   10   11   12   14   15   16   17   20   21   22   23   24   25   26   27   28   29   30   31   32   33   37   39 </span></span>
<span><span class="co">#&gt;  354  184   80   45   24   18    7    5    6    1    2    1    4    1    1    2    2    2    2    2    1    2    2    1    1    2    2    2    1    2    3    1    1 </span></span>
<span><span class="co">#&gt;   48   49   51   52   57   64   66   70   72   73   79   83   90   91   95   96  102  104  136  166  170  221  264  726 1009 1469 </span></span>
<span><span class="co">#&gt;    1    1    2    1    2    1    1    1    1    1    1    1    1    1    1    1    2    1    1    1    1    1    1    1    1    1</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.030   0.062   0.092</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="plot-overall-survival-curve">Plot overall survival curve<a class="anchor" aria-label="anchor" href="#plot-overall-survival-curve"></a>
</h2>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span><span class="va">osurv</span><span class="op">~</span><span class="fl">1</span><span class="op">)</span>, main <span class="op">=</span> <span class="st">"Overall BRCA Survival"</span>, xlab <span class="op">=</span> <span class="st">"Years"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-lksurv-1.png" width="100%"></p>
</div>
<div class="section level2">
<h2 id="compare-to-gdc-data-portal-plot">Compare to GDC Data Portal plot<a class="anchor" aria-label="anchor" href="#compare-to-gdc-data-portal-plot"></a>
</h2>
<p>The display, based on 793 observations with non-missing TCGA OS.Time, is consistent with the display at the <a href="https://portal.gdc.cancer.gov/exploration?filters=%7B%22op%22%3A%22and%22%2C%22content%22%3A%5B%7B%22content%22%3A%7B%22field%22%3A%22cases.diagnoses.tissue_or_organ_of_origin%22%2C%22value%22%3A%5B%22axillary%20tail%20of%20breast%22%2C%22breast%2C%20nos%22%2C%22central%20portion%20of%20breast%22%2C%22lower-inner%20quadrant%20of%20breast%22%2C%22lower-outer%20quadrant%20of%20breast%22%2C%22nipple%22%2C%22overlapping%20lesion%20of%20breast%22%2C%22upper-inner%20quadrant%20of%20breast%22%2C%22upper-outer%20quadrant%20of%20breast%22%5D%7D%2C%22op%22%3A%22in%22%7D%2C%7B%22content%22%3A%7B%22field%22%3A%22cases.primary_site%22%2C%22value%22%3A%5B%22breast%22%5D%7D%2C%22op%22%3A%22in%22%7D%2C%7B%22op%22%3A%22in%22%2C%22content%22%3A%7B%22field%22%3A%22cases.project.program.name%22%2C%22value%22%3A%5B%22TCGA%22%5D%7D%7D%5D%7D&amp;searchTableTab=genes" class="external-link">GDC Data Portal</a>, based on 1077 cases.</p>
</div>
</div>
<div class="section level1">
<h1 id="obtain-gene-stratified-survival">Obtain gene-stratified survival<a class="anchor" aria-label="anchor" href="#obtain-gene-stratified-survival"></a>
</h1>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gstrat</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sym</span><span class="op">=</span><span class="st">"TTN"</span>, <span class="va">mutlist</span>, <span class="va">survdat</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">survdat</span>, <span class="st">"Surv"</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html" class="external-link">stopifnot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">survdat</span><span class="op">)</span> <span class="op">==</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">mutlist</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">hassym</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">sym</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">mutlist</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span><span class="va">survdat</span><span class="op">~</span><span class="va">hassym</span><span class="op">)</span>, main<span class="op">=</span><span class="va">sym</span>, lty<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, xlab<span class="op">=</span><span class="st">"Years"</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">gstrat</span><span class="op">(</span><span class="st">"TTN"</span>, <span class="va">mutsyms</span>, <span class="va">osurv</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-dogs-1.png" width="100%"></p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">gstrat</span><span class="op">(</span><span class="st">"TP53"</span>, <span class="va">mutsyms</span>, <span class="va">osurv</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-dogs-2.png" width="100%"></p>
<div class="section level2">
<h2 id="frequencies">Frequencies<a class="anchor" aria-label="anchor" href="#frequencies"></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">commut</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="va">mutsyms</span><span class="op">)</span><span class="op">)</span>, decreasing <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fl">30</span><span class="op">)</span></span>
<span><span class="va">commut</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  PIK3CA     TTN    TP53   MUC16   GATA3  MAP3K1   MUC12    MLL3    MUC4   SYNE1    CDH1    RYR2 CROCCP2     DST     FLG     DMD    SPEN   FCGBP   USH2A   HMCN1 </span></span>
<span><span class="co">#&gt;     312     300     272     134      97      91      78      75      69      65      64      62      58      58      56      52      52      51      51      50 </span></span>
<span><span class="co">#&gt;    RYR3   SYNE2   AHNAK   MUC5B     NEB   OBSCN  AHNAK2    APOB   XIRP2    HRNR </span></span>
<span><span class="co">#&gt;      50      50      48      48      47      47      46      45      45      43</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="log-mutation-count-per-tumor">Log mutation count per tumor<a class="anchor" aria-label="anchor" href="#log-mutation-count-per-tumor"></a>
</h2>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">mutsyms</span>,<span class="va">length</span><span class="op">)</span><span class="op">)</span>, main<span class="op">=</span><span class="st">"Log mutation count per tumor"</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-lkhist-1.png" width="100%"></p>
</div>
</div>
<div class="section level1">
<h1 id="combinations-of-mutations">Combinations of mutations<a class="anchor" aria-label="anchor" href="#combinations-of-mutations"></a>
</h1>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hasmut</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sym</span><span class="op">=</span><span class="st">"TP53"</span>, <span class="va">mutlist</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">mutlist</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">sym</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu">hasmut</span><span class="op">(</span><span class="st">"TP53"</span>, <span class="va">mutsyms</span><span class="op">)</span>, <span class="fu">hasmut</span><span class="op">(</span><span class="st">"PIK3CA"</span>, <span class="va">mutsyms</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;        </span></span>
<span><span class="co">#&gt;         FALSE TRUE</span></span>
<span><span class="co">#&gt;   FALSE   341  198</span></span>
<span><span class="co">#&gt;   TRUE    192   62</span></span></code></pre></div>
<div class="section level2">
<h2 id="assemble-pairs">Assemble pairs<a class="anchor" aria-label="anchor" href="#assemble-pairs"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">common_pairs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/combn.html" class="external-link">combn</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">commut</span><span class="op">)</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">common_pairs</span><span class="op">[</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span></span>
<span><span class="co">#&gt;      [,1]     [,2]     [,3]     [,4]    </span></span>
<span><span class="co">#&gt; [1,] "PIK3CA" "PIK3CA" "PIK3CA" "PIK3CA"</span></span>
<span><span class="co">#&gt; [2,] "TTN"    "TP53"   "MUC16"  "GATA3"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="greedy-search-for-deleterious-pairs">Greedy search for deleterious pairs<a class="anchor" aria-label="anchor" href="#greedy-search-for-deleterious-pairs"></a>
</h2>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">indicate_pair</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">sym1</span>, <span class="va">sym2</span>, <span class="va">mutlist</span><span class="op">)</span></span>
<span>  <span class="fu">hasmut</span><span class="op">(</span><span class="va">sym1</span>, <span class="va">mutlist</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu">hasmut</span><span class="op">(</span><span class="va">sym2</span>, <span class="va">mutlist</span><span class="op">)</span></span>
<span><span class="va">chk</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">common_pairs</span>,<span class="fl">2</span>,<span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span> <span class="fu">indicate_pair</span><span class="op">(</span><span class="va">z</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="va">z</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="va">mutsyms</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">chkp.inds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">chk</span>,<span class="fl">2</span>,<span class="va">sum</span><span class="op">)</span><span class="op">&gt;</span><span class="fl">20</span><span class="op">)</span> <span class="co"># disallow very rare combos</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">chk</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 793 435</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/dim.html" class="external-link">dim</a></span><span class="op">(</span><span class="va">chk</span><span class="op">[</span>,<span class="va">chkp.inds</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 793  15</span></span>
<span><span class="va">chisqs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html" class="external-link">apply</a></span><span class="op">(</span><span class="va">chk</span><span class="op">[</span>,<span class="va">chkp.inds</span><span class="op">]</span>,<span class="fl">2</span>,<span class="kw">function</span><span class="op">(</span><span class="va">z</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html" class="external-link">survdiff</a></span><span class="op">(</span><span class="va">osurv</span><span class="op">~</span><span class="va">z</span><span class="op">)</span><span class="op">$</span><span class="va">chisq</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">chisqs</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-lkpairs-1.png" width="100%"></p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cpr</span> <span class="op">&lt;-</span> <span class="va">common_pairs</span><span class="op">[</span>,<span class="va">chkp.inds</span><span class="op">]</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">chisqs</span><span class="op">&gt;</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survfit.html" class="external-link">survfit</a></span><span class="op">(</span><span class="va">osurv</span><span class="op">~</span><span class="va">chk</span><span class="op">[</span>,<span class="va">chkp.inds</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">chisqs</span><span class="op">&gt;</span><span class="fl">5</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, lty<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, main<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">cpr</span>, collapse<span class="op">=</span><span class="st">" &amp; "</span> <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="reference/figures/README-lkpairs-2.png" width="100%"></p>
</div>
</div>
<div class="section level1">
<h1 id="using-domain-classification-of-mutations">Using domain classification of mutations<a class="anchor" aria-label="anchor" href="#using-domain-classification-of-mutations"></a>
</h1>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dom</span> <span class="op">&lt;-</span> <span class="fu">assay</span><span class="op">(</span><span class="va">bmut.surv</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span>, <span class="st">"domain_WU"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Znf"</span>, <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">dom</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># frequently noted</span></span>
<span><span class="co">#&gt; [1] 1857</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/register.html" class="external-link">register</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/MulticoreParam-class.html" class="external-link">MulticoreParam</a></span><span class="op">(</span><span class="fu">parallel</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/parallel/detectCores.html" class="external-link">detectCores</a></span><span class="op">(</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1L</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span></span>
<span>    <span class="va">mutdoms</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocParallel/man/bplapply.html" class="external-link">bplapply</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">dom</span><span class="op">)</span><span class="op">)</span>,</span>
<span>        <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="va">dom</span><span class="op">[</span>,<span class="va">x</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.172   2.421   3.241</span></span></code></pre></div>
<div class="section level2">
<h2 id="isolate-individuals-with-mutations">Isolate individuals with mutations<a class="anchor" aria-label="anchor" href="#isolate-individuals-with-mutations"></a>
</h2>
<div class="section level3">
<h3 id="znf-domain">Znf domain<a class="anchor" aria-label="anchor" href="#znf-domain"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">noz</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">mutdoms</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"Znf"</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="va">noz</span><span class="op">)</span></span>
<span><span class="co">#&gt; noz</span></span>
<span><span class="co">#&gt; FALSE  TRUE </span></span>
<span><span class="co">#&gt;   520   273</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html" class="external-link">survdiff</a></span><span class="op">(</span><span class="va">osurv</span><span class="op">~</span><span class="va">noz</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; survdiff(formula = osurv ~ noz)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;             N Observed Expected (O-E)^2/E (O-E)^2/V</span></span>
<span><span class="co">#&gt; noz=FALSE 520       51     50.1    0.0168    0.0395</span></span>
<span><span class="co">#&gt; noz=TRUE  273       37     37.9    0.0221    0.0395</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Chisq= 0  on 1 degrees of freedom, p= 0.8</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="sh3">SH3<a class="anchor" aria-label="anchor" href="#sh3"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nosh3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">mutdoms</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"SH3"</span>, <span class="va">x</span><span class="op">)</span><span class="op">)</span><span class="op">==</span><span class="fl">0</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/survival/man/survdiff.html" class="external-link">survdiff</a></span><span class="op">(</span><span class="va">osurv</span><span class="op">~</span><span class="va">nosh3</span><span class="op">)</span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; survdiff(formula = osurv ~ nosh3)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;               N Observed Expected (O-E)^2/E (O-E)^2/V</span></span>
<span><span class="co">#&gt; nosh3=FALSE 109        8     8.32   0.01215    0.0136</span></span>
<span><span class="co">#&gt; nosh3=TRUE  684       80    79.68   0.00127    0.0136</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  Chisq= 0  on 1 degrees of freedom, p= 0.9</span></span></code></pre></div>
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small>CC0</small></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing RaggedExperiment.SoftNote</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="https://LiNk-NY.github.io/" class="external-link">Marcel Ramos</a> <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0002-3242-0582" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>Martin Morgan <br><small class="roles"> Author </small> <a href="https://orcid.org/0000-0002-5874-8148" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li>
<a href="https://waldronlab.io/" class="external-link">Levi Waldron</a> <br><small class="roles"> Author, contributor </small> <a href="https://orcid.org/0000-0003-2725-0694" target="orcid.widget" aria-label="ORCID" class="external-link"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">More about authors...</a></li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://LiNk-NY.github.io/" class="external-link">Marcel Ramos</a>, Martin Morgan, <a href="https://waldronlab.io/" class="external-link">Levi Waldron</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
